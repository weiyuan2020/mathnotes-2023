参考 
[知乎专栏文章](https://zhuanlan.zhihu.com/p/58738073)
[wikipedia](https://zh.wikipedia.org/zh-hans/%E6%9D%8E%E9%9B%85%E6%99%AE%E8%AF%BA%E5%A4%AB%E7%A8%B3%E5%AE%9A%E6%80%A7)

## 李雅普诺夫第一法

线性系统容易计算 性能较好
只要保证矩阵A具有负实部 就是大范围一致稳定的
将方程形式有非线性形式写为线性形式
$$
\dot{\boldsymbol{x}}(t) = f(\boldsymbol{x}(t))
$$
$$
\dot{x}(t) = Ax(t)
$$

将非线性系统平衡态附近线性化
讨论线性化特征值分布 以 研究非线性系统稳定性问题


倒立摆
$$
\begin{align}
\dot{x}_{1}(t) & = x_{2} \\
\dot{x}_{2}(t) & = \sin(x_{1}) - x_{2} 
\end{align}
$$
根据计算结果 该系统有多个平衡点 $[\pm n\pi \quad 0]'$
$[\pi \quad 0]'$ 点附近的状态轨迹
![[Pasted image 20230215164141.png]]

非线性系统线性化
为简化问题 定义 $z_{1}=x_{1}-\pi,z_{2}=x_{2}$
$$
\sin(\pi+z_{1})=-\sin z_{1}\approx -z_{1}
$$
(小扰动假设)

原非线性方程变为
$$
\begin{bmatrix}
\dot{z}_{1} \\
\dot{z}_{2} \\
\end{bmatrix}
= 
\begin{bmatrix}
0 & 1  \\
-1 & -1
\end{bmatrix}
\begin{bmatrix}
z_{1}  \\
z_{2} 
\end{bmatrix}
$$
新坐标系下 平衡点为 $[0,0]'$ 
轨迹为
![](attachments/控制系统%20李雅普诺夫稳定性%20第一法与第二法-.png)

一般的书上，对于李雅普诺夫第一法都是一笔带过，其实在工程实践中，第一法应用非常多，比如复杂的飞机飞行控制，就是将飞机模型线性化成多个线性化模型进行设计，感兴趣的可参见[Design an LQR Servo Controller in Simulink](https://ww2.mathworks.cn/help/control/getstart/design-an-lqr-servo-controller-in-simulink.html)。


## 李雅普诺夫第二法
稳定的系统能量总是不断被耗散的，李雅普诺夫通过定义一个标量函数 $V(x)$（通常能代表广义能量）来分析稳定性。这种方法的避免了直接求解方程，也没有进行近似线性化，所以也一般称之为直接法。如果标量函数 $V(x)$ 满足：
- $V(x)=0$ if and only if $x=0$ 
- $V(x)>0$ if and only if $x\neq 0$ 
- $\dot{V}(x)=\frac{d}{dt}V(x)=\sum_{i=1}^{n}\frac{ \partial V }{ \partial x_{i} }f_{i}(x)\leq 0$ when $x\neq 0$ 
则称系统在李雅普诺夫意义下是稳定的
特别的 若 $x\neq 0$ 时  有 $\dot{V}(x)<0$  则系统是渐进稳定的

举例
$$
\begin{align}
\dot{x}_{1} (t) & = x_{2} - x_{1} (x_{1}^{2} + x_{2}^{2}) \\
\dot{x}_{2} (t) & = -x_{1} - x_{2} (x_{1}^{2} + x_{2}^{2}) \\
\end{align}
$$
定义李雅普诺夫函数 (是自己定义的)
$$
V(x) = x_{1}^{2} + x_{2}^{2}
$$
则有
$$
\begin{align}
\dot{V}(x) & = 2x_{1}\dot{x}_{1} + 2x_{2}\dot{x}_{2} \\
  & = -2 (x_{1}^{2} + x_{2}^{2})^{2}
\end{align}
$$
显然 $x\neq 0$ 时 有 $\dot{V}(x)<0$ 所以系统是渐进稳定的

合理选择李雅普诺夫函数 可以非常容易地判断系统稳定性 但李雅普诺夫函数的选择没有现成的规律可循




# matlab 代码

```matlab
% 定义状态方程
function d=dxdt(t,x)

d=[ x(2)+x(1)*(2-x(1)^2-x(2)^2); 
    -x(1)+x(2)*(2-x(1)^2-x(2)^2) ]; 
```

```matlab
% 根据状态方程，画出变量轨迹
figure('color','w');
hold on 
for theta=[0:20]*pi/10
    x0=3*[cos(theta);sin(theta)];%定义初始值数组
    [t,x]=ode45(@dxdt,[0:0.1:8],x0);
    plot(x(:,1),x(:,2),'linewidth',0.5)
    quiver(x(:,1),x(:,2),gradient(x(:,1)),gradient(x(:,2)),'linewidth',3.0);%增加轨迹方向箭头
end
for theta=[0:2:20]*pi/10
    x0=1e-5*[cos(theta);sin(theta)];
    [t,x]=ode45(@dxdt,[0:0.2:20],x0);
    plot(x(:,1),x(:,2),'linewidth',0.5)
    quiver(x(:,1),x(:,2),gradient(x(:,1)),gradient(x(:,2)),'linewidth',1.5)
    xlabel('x1','FontSize',18,'FontWeight','bold','Color','r');
    ylabel('x2','FontSize',18,'FontWeight','bold','Color','r')
    title('Made by J PAN')
end
```

---

# 李雅普诺夫稳定性 wikipedia 

在数学和自动控制领域中，李雅普诺夫稳定性（英语：Lyapunov stability，或李亚普诺夫稳定性）可用来描述一个动力系统的稳定性。如果此动力系统任何初始条件在 $x_{0}$ 附近的轨迹均能维持在 $x_{0}$ 附近，那么该系统可以称为在 $x_{0}$处**李雅普诺夫稳定**。

若任何初始条件在  $x_{0}$ 附近的轨迹最后都趋近 $x_{0}$ ，那么该系统可以称为在 $x_{0}$ 处**渐近稳定**。指数稳定可用来保证系统最小的衰减速率，也可以估计轨迹收敛的快慢。

李雅普诺夫稳定性可用在线性及非线性的系统中。不过线性系统的稳定性可由其他方式求得，因此李雅普诺夫稳定性多半用来分析非线性系统的稳定性。李亚普诺夫稳定性的概念可以延伸到无限维的流形，即为结构稳定性，是考虑微分方程中一群不同但“接近”的解的行为。输入-状态稳定性（ISS）则是将李雅普诺夫稳定性应用在有输入的系统。

![[attachments/控制系统 李雅普诺夫稳定性 第一法与](attachments/控制系统%20李雅普诺夫稳定性%20第一法与第二法--1.png)

当启始点在区域V内，而轨迹均维持在区域U内（在 $x_{0}$ 附近），则系统在 $x_{0}$ 处为李雅普诺夫稳定



## 连续时间系统下的定义

给定一个完备的赋范向量空间 如$\mathbb{R}^{n}$ 
设 U 是 E 的开子集
考虑一个自治的非线性动力系统
$$
\dot{x}=f(x(t)), \quad x(t_{0})=x_{0} 
$$
其中 $x(t)\in U$ 是系统的状态向量 $f:U\rightarrow E$ 是 U 上的连续函数
假设函数 f 有一个零点 : $f(a)=0$， 则常数函数 $x=a$ 是动力系统的驻定解 (平衡解) 称 a 是动力系统的平衡点
1. 称点 a 李雅普诺夫稳定 (简称稳定)   如果对每个 $\epsilon>0$ 均存在 $\delta=\delta(\epsilon)>0$ 使得对所有满足 $\lvert| x_{0}-a \rvert|<\delta$  的 $x_{0}$ 只要 $t\geq t_{0}$ 就有 $\lvert| x(t)-a \rvert|<\epsilon$   
2. 称点 a 渐进稳定    如果点a 李雅普诺夫稳定 且存在 $\delta>0$ 使得对所有满足 $\lvert| x_{0}-a \rvert|<\delta$  的 $x_{0}$ $\lim_{ t \to \infty }x(t)=a$ 
3. 称点 a 指数稳定    如果点a 渐进稳定 且存在 $\alpha,\beta,\delta>0$ 使得对所有满足 $\lvert| x_{0}-a \rvert|<\delta$  的 $x_{0}$  只要 $t\geq t_{0}$ 就有 $\lvert| x(t)-a \rvert| \leq \alpha \lvert| x_{0}-a \rvert|e^{-\beta t}$ 

它们的直观几何意义是：

1.  平衡点为李雅普诺夫稳定的，表示若动力系统状态函数（微分方程的解函数）的初值“足够接近”平衡点，则它会永远维持在平衡点附近任意小的范围里（距平衡点的距离不超过任意选择的正实数 $\epsilon$）。
2.  渐近稳定的意思是，初值足够接近平衡点的状态函数，不但维持在平衡点附近，而且最后会收敛到平衡点。
3.  指数稳定的意思是，状态函数不但最后会收敛到平衡点，且收敛速度不慢于某种指数递减的速度。

设有状态函数 $x$ 初值 $x(t_{0})=x_{0}$ 
称 $\bar{x}=\left\{ x(t);t\geq t_{0} \right\}$ 为 $x$ 的轨迹
如果对所有初值与 $x$ 相近的状态函数 $y$ 两者的轨迹会趋于相同
$$
\lim_{ t \to \infty } \lvert| y(t) - x(t) \rvert| \rightarrow 0
$$

则称x的轨迹有（局部）吸引性（attractive）。若上述条件对所有y均成立，则称x有全局吸引性（globally attractive）。

如果x的轨迹有吸引性，并且稳定，则x渐近稳定。不过，x有吸引性不表示它的轨迹渐近稳定。

## 迭代系统下的定义

给定度量空间 $(X,d)$。设 $f: X\to X$ 为一连续函数。称点 $a\in X$ 为**李雅普诺夫稳定**，
如果对任意 $\epsilon >0$，都存在 $\delta >0$，使得只要 $x \in X$ 满足$d(x,a)<\delta$ ，就有
$$
\forall n \in \mathbb{N}, d(f^{n}(x), f^{n}(a)) < \epsilon 
$$
称点 a **渐近稳定**，

如果a是李雅普诺夫稳定的点，而且在稳定点集合的内部，即存在 $\delta >0$，使得只要$x \in X$满足$d(x,a)<\delta$ ，就有
$$
\lim_{ n \to \infty }  d(f^{n}(x), f^{n}(a)) = 0 
$$

## 李雅普诺夫稳定性理论

对于微分方程解之稳定性的研究称为稳定性理论。而李雅普诺夫稳定性定理只提供了稳定性的充分条件。

### 李雅普诺夫稳定性第二定理

考虑函数 $V(x)\colon \mathbb{R}^{n}\to \mathbb{R}$ 使得
- $V(x)\geq 0$ 只有在 $x=0$ 处等号成立 (正定函数)
- $\dot{V}(x(t))<0$ (负定)

则$V(x)$称为李雅普诺夫候选函数（Lyapunov function candidate），且系统（依李雅普诺夫的观点）为**渐近稳定**。

上式中 $V(0)=0$ 是必要的条件。否则，
$V(x)=1/(1+|x|)$可以用来“证明”  ${\dot  x}(t)=x$ 有区域性稳定。
另一个称为径向无界性（radial unboundedness）的条件则是用来得到全域渐近稳定的结果。

此种分析方式可类比为考虑一物理系统（如弹簧及质量的系统）及其中的能量。若系统能量随时间递减，且减少的能量不会恢复，而此系统最后一定会静止于某个特定的状态。最后的状态称为吸引子。不过针对一个物理系统，找到表达其精确能量的函数不一定容易，而且针对抽象数学系统、经济系统或生物系统，上述能量的概念又不一定适用。

利用李雅普诺夫的分析方式，可在不知道系统实际能量的情形下，证明系统的稳定性。不过前提是可以找到满足上述限制的李雅普诺夫函数。

举例 考虑以下系统
$$
\dot{x} = -x^{3}
$$
使用李雅普诺夫函数确认 $x=0$ 附近的稳定性 令 
$$
V(x) = 0.5 x^{2}
$$
$V(x)$ 本身为正定函数 其导函数如下
$$
\dot{V}(x(t)) = \frac{ \partial V }{ \partial x } (-x^{3}) = -x^{4}
$$
为负定函数 因此上述系统在 $x=0$ 附近渐进稳定

## 线性系统状态空间模型的稳定性 

$$
\dot{\mathbf{x}} = A \mathbf{x}
$$
该线性状态空间模型渐进稳定 (其实是指数稳定 ( #my-notes why???? ))

若 
$$
A^{T}M + MA + N = 0
$$
的解存在

其中 $N=N^{T}>0, M=M^{T}>0$ (正定矩阵)
对于李雅普诺夫函数 $V\left( x \right) = x^{T}Mx$ 


## 有输入值系统的稳定性

$\mathbf{x} = \mathbf{f(x,u)}$
$\mathbf{u}$ 可为 控制 外部输入 扰动 刺激或外力
